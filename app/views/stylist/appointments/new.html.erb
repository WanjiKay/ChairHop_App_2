<div class="container py-4">
  <h1 class="fw-bold text-primary mb-4">Create Availability</h1>

  <%= form_with(model: [:stylist, @appointment], class: "dashboard-section p-4") do |f| %>
    <% if @appointment.errors.any? %>
      <div class="alert alert-danger">
        <h6 class="fw-bold mb-2"><%= pluralize(@appointment.errors.count, "error") %> prohibited this from being saved:</h6>
        <ul class="mb-0">
          <% @appointment.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="row">
      <div class="col-md-6 mb-3">
        <%= f.label :time, "Date & Time", class: "form-label fw-semibold" %>
        <%= f.datetime_local_field :time, class: "form-control",
            min: Time.current.strftime("%Y-%m-%dT%H:%M") %>
        <small class="text-muted">When are you available?</small>
      </div>

      <div class="col-md-6 mb-3">
        <%= f.label :location, class: "form-label fw-semibold" %>
        <%= f.text_field :location, class: "form-control",
            placeholder: "e.g., Downtown Studio, 123 Main St",
            value: @appointment.location.presence || current_user.location %>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <%= f.label :salon, "Salon / Studio Name", class: "form-label fw-semibold" %>
        <%= f.text_field :salon, class: "form-control",
            placeholder: "e.g., Glow Lounge, Chic Studio" %>
      </div>

      <div class="col-md-6 mb-3">
        <label class="form-label fw-semibold">Service</label>
        <% if @services.any? %>
          <%= select_tag "service_ids[]",
              options_for_select(@services.map { |s| ["#{s.name} - $#{number_with_precision(s.price, precision: 2)}", s.id] }),
              prompt: "Select a service",
              class: "form-select",
              required: true %>
          <small class="text-muted">Choose which service this appointment is for</small>
        <% else %>
          <div class="alert alert-light mb-0">
            <p class="mb-2">No services created yet.</p>
            <%= link_to "Create services first", new_stylist_service_path, class: "btn btn-outline-primary btn-sm" %>
          </div>
        <% end %>
      </div>
    </div>

    <div class="mb-3">
      <%= f.label :content, "Additional Notes", class: "form-label fw-semibold" %>
      <%= f.text_area :content, class: "form-control", rows: 2,
          placeholder: "Any additional details for customers (optional)" %>
    </div>

    <div class="d-flex gap-2 mt-2">
      <%= f.submit "Create Availability", class: "btn btn-primary" %>
      <%= link_to "Cancel", stylist_appointments_path, class: "btn btn-outline-secondary" %>
    </div>
  <% end %>
</div>
